# Rella Analytics Dashboard - Project Context for AI Assistant\n\n## Project Goal\n\nBuild a web-based analytics dashboard for \"Rella\" (likely a MedSpa or similar business) using Python/Flask for the backend and React for the frontend. The dashboard should display key performance indicators (KPIs), visualizations, and eventually provide predictive insights and potentially AI-driven summaries.\n\n## Current Status (As of last interaction)\n\n*   **Core Architecture:** Flask backend, React frontend, basic project structure established.\n*   **Database:** SQLite database (`backend/instance/rella_analytics.sqlite`) set up.\n*   **Schema:** Includes tables for locations, treatment categories, services, products, employees, customers, bookings, transactions, and transaction items (`backend/schema.sql`).\n*   **Data:** Database is seeded with mock data for basic entities and *simulated* data for bookings and transactions (Q1 2024) via `flask seed-db` command (`backend/app.py`).\n*   **Backend API (`backend/app.py`):**\n    *   Basic endpoints to fetch locations, categories, services, products, employees (querying DB).\n    *   `/kpis` endpoint calculates KPIs (Total Sales, Avg. Txn Value, New Customers, Booking Conversion) by querying simulated transaction/booking data.\n    *   `/sales/by_category` aggregates sales by category from DB.\n    *   `/sales/forecast` implements illustrative SARIMA sales forecasting using simulated data.\n    *   Data upload endpoints (`/validate_transactions`, `/process_transactions`) for replacing transaction data via CSV upload are implemented.\n*   **Frontend UI (`frontend/src`):**\n    *   Dashboard page (`DashboardPage.jsx`) displays KPIs, charts, tables, and filters.\n    *   Components include: `KPI_Card`, `CategorySalesPieChart`, `TopItemsTable`, `SummaryWidget` (rule-based), `DataUploadWidget`, `SalesForecastChart`.\n    *   Filtering by Location and Date Range is functional, triggering API refetches.\n    *   API service (`api.js`) connects frontend to backend (currently set to `http://localhost:5000/api/v1`).\n*   **Styling:** Basic CSS is in place, layout uses CSS Grid.\n\n## Key Learnings & Decisions\n\n*   Initial CSV data lacked granularity (timestamps, transaction IDs) for desired analysis.\n*   Simulated data is used for transactions, bookings, and forecasting - results are illustrative.\n*   SQLite used for development simplicity.\n*   User prefers seeing illustrative examples.\n*   Chose SARIMA for initial forecasting example.\n*   Attempted Market Basket Analysis (Association Rules) but encountered persistent issues.\n\n## Recent Troubleshooting & Current Issues\n\n*   **Association Rules Feature Removed:** We implemented an `/api/v1/analysis/association_rules` endpoint using `mlxtend` and a corresponding frontend widget. However, we encountered a persistent issue where Flask would not register or route requests to this specific endpoint, even in a simplified debug state. Requests resulted in a 200 OK status but a blank HTML response, and backend logs never showed the route being hit. We tried moving the route definition, checking imports, setting FLASK_APP, clearing pycache, changing the route path - none worked. The feature (backend endpoint, frontend component) was removed/commented out to move forward.\n*   **Port Mismatch:** Resolved an issue where the frontend was calling port 5001 while the backend was running on 5000. Frontend `api.js` now points to port 5000.\n*   **Terminal Commands:** User's shell environment (PowerShell) doesn't reliably handle `&&` for chaining commands; use separate commands instead.\n*   **Hook Errors:** Resolved React \"Invalid hook call\" errors related to `react-datepicker` by explicitly adding `react` and `react-dom` to frontend dependencies and reinstalling.\n\n## Next Steps (Before interruption)\n\nWe were about to proceed with integrating Google's Gemini API to create a true AI-powered summary for the `SummaryWidget`, replacing the current rule-based one. This involved installing `google-generativeai`, setting the `GOOGLE_API_KEY` environment variable, and creating a new backend endpoint.\n\n## Setup Notes for New Machine\n\n1.  Copy entire project folder.\n2.  Install Python 3.10+ and Node.js LTS.\n3.  **Backend:**\n    *   `cd backend`\n    *   `python -m venv venv`\n    *   `.\venv\Scripts\activate` (or equivalent)\n    *   `python -m pip install -r requirements.txt`\n    *   `$env:FLASK_APP = 'app.py'` (PowerShell)\n    *   `$env:GOOGLE_API_KEY = 'YOUR_API_KEY_HERE'` (PowerShell, if resuming AI features)\n    *   `python -m flask init-db`\n    *   `python -m flask seed-db`\n    *   `python -m flask run` (Keep running)\n4.  **Frontend:**\n    *   Open NEW terminal\n    *   `cd frontend`\n    *   `npm install`\n    *   `npm run dev` (Keep running)\n5.  Access frontend at `http://localhost:5173` (or check `npm run dev` output for port).\n 